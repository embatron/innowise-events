schema:
  event_schema:
    name: "Event schema"
    types:
      - EventType

types:
  EventType:
    type: object
    fields:
      id:
        type: String
        resolve: "@=entity.id()"
      title:
        type: String
        resolve: "@=entity.label()"
      start_date:
        type: String
        resolve: "@=entity.get('event_start_date').value"
      end_date:
        type: String
        resolve: "@=entity.get('event_end_date').value"
      participants_count:
        type: Int
        resolve: "@=count(entity.get('participants').referencedEntities())"

fields:
  allActiveEvents:
    type: "[EventType]"
    resolve: "@=service('innowise_events.active_event_resolver').resolve()"

  eventById:
    type: "EventType"
    args:
      id:
        type: String
    resolve: "@=service('innowise_events.event_by_id_resolver').resolve(arguments['id'])"

  registerForEvent:
    type: "Boolean"
    args:
      event_id:
        type: String
    resolve: "@=service('innowise_events.register_event_resolver').resolve(arguments['event_id'], user)"
